<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Postagens por G√™nero</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
  <style>
    body {
      background-color: #121212;
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .sidebar {
      background-color: #1e1e1e;
      padding: 1rem;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      width: 250px;
      overflow-y: auto;
      z-index: 1030;
      transition: transform 0.3s ease;
    }

    .sidebar.hidden {
      transform: translateX(-270px);
    }

    .sidebar a,
    .sidebar .dropdown-toggle {
      display: block;
      color: #ffffff;
      text-decoration: none;
      margin-bottom: 0.5rem;
    }

    .sidebar a:hover,
    .sidebar .dropdown-toggle:hover {
      color: #00bcd4;
    }

    .dropdown-menu {
      background-color: #2c2c2c;
    }

    .dropdown-item {
      color: white;
    }

    .dropdown-item:hover {
      background-color: #00bcd4;
      color: black;
    }

    .main-content {
      margin-left: 270px;
      padding: 2rem;
    }

    .card {
      background-color: #1e1e1e;
      color: white;
      margin-bottom: 1rem;
    }

    .card:hover {
      box-shadow: 0 0 10px rgba(0, 188, 212, 0.3);
    }

    .toggle-btn {
      background: none;
      border: none;
      color: #ffffff;
      font-size: 1.8rem;
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1051;
    }
  </style>
</head>

<body>

  <!-- Navbar -->
  <nav class="navbar navbar-dark bg-dark px-3 justify-content-between">
    <div class="d-flex align-items-center">
      <button class="toggle-btn d-md-none" id="btnToggleSidebar">
        <span class="material-icons">menu</span>
      </button>
      <a class="navbar-brand ms-3" href="#">ChronoZone</a>
    </div>
    <div id="navbar-user-area">
      <a href="criar-post.html" class="btn btn-success btn-sm me-2">+ Criar</a>
      <button class="btn btn-outline-light btn-sm me-2" data-bs-toggle="modal"
        data-bs-target="#loginModal">Entrar</button>
      <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#signupModal">Cadastrar</button>
    </div>
  </nav>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <h4><a class="text-center mt-4 fs-4" href="index.html">ChronoZone</a></h4>
    <h5>G√™neros</h5>
    <div class="dropdown mb-2">
      <a class="dropdown-toggle" href="postagem.html?genero=Filmes" role="button" data-bs-toggle="dropdown"
        aria-expanded="false">üé¨ Filmes</a>
      <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="postagem.html?genero=A√ß√£o">A√ß√£o</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Aventura">Aventura</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Terror">Terror</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Com√©dia">Com√©dia</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Drama">Drama</a></li>
      </ul>
    </div>
    <div class="dropdown mb-2">
      <a class="dropdown-toggle" href="postagem.html?genero=S√©ries" role="button" data-bs-toggle="dropdown"
        aria-expanded="false">üì∫ S√©ries</a>
      <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="postagem.html?genero=Suspense">Suspense</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Sci-Fi">Sci-Fi</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Fantasia">Fantasia</a></li>
      </ul>
    </div>
    <div class="dropdown mb-2">
      <a class="dropdown-toggle" href="postagem.html?genero=Jogos" role="button" data-bs-toggle="dropdown"
        aria-expanded="false">üéÆ Jogos</a>
      <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="postagem.html?genero=FPS">FPS</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=RPG">RPG</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Plataforma">Plataforma</a></li>
      </ul>
    </div>
    <div class="dropdown mb-2">
      <a class="dropdown-toggle" href="postagem.html?genero=Desenhos" role="button" data-bs-toggle="dropdown"
        aria-expanded="false">üß∏ Desenhos</a>
      <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="postagem.html?genero=Cl√°ssicos">Cl√°ssicos</a></li>
        <li><a class="dropdown-item" href="postagem.html?genero=Modernos">Modernos</a></li>
      </ul>
    </div>
    <a href="postagem.html?genero=Animes">üìö Animes</a>
    <a href="postagem.html?genero=Super-her√≥is">ü¶∏‚Äç‚ôÇÔ∏è Super-her√≥is</a>
  </div>

  <!-- Conte√∫do principal -->
  <div class="main-content">
    <h1 id="tituloGenero">Postagens</h1>
    <div class="row" id="listaPosts"></div>
  </div>

  <!-- Modais login/cadastro -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-white">
        <div class="modal-header">
          <h5 class="modal-title">Entrar</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="email" class="form-control mb-3" placeholder="Email">
          <input type="password" class="form-control mb-3" placeholder="Senha">
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
          <button class="btn btn-primary">Entrar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="signupModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-white">
        <div class="modal-header">
          <h5 class="modal-title">Cadastro</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="text" class="form-control mb-3" placeholder="Nome completo">
          <input type="email" class="form-control mb-3" placeholder="Email">
          <input type="password" class="form-control mb-3" placeholder="Senha">
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button class="btn btn-success">Cadastrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="Js/autenticacao.js"></script>
  <script>
    document.getElementById("btnToggleSidebar").addEventListener("click", () => {
      document.getElementById("sidebar").classList.toggle("hidden");
    });

    document.addEventListener("DOMContentLoaded", () => {
      const params = new URLSearchParams(window.location.search);
      const genero = params.get("genero");
      const titulo = document.getElementById("tituloGenero");
      const lista = document.getElementById("listaPosts");

      if (genero) {
        titulo.textContent = `Postagens sobre ${genero}`;
        const posts = JSON.parse(localStorage.getItem("postagens")) || [];
        const filtrados = posts.filter(p => p.genero === genero);

        if (filtrados.length === 0) {
          lista.innerHTML = `<p>Ainda n√£o h√° postagens sobre ${genero}.</p>`;
        } else {
          filtrados.forEach((post, index) => {
            const card = document.createElement("div");
            card.className = "card p-3 col-12 mb-3";
            card.style.cursor = "pointer";
            card.innerHTML = `
            <h4>${post.titulo}</h4>
            <p>${post.texto.slice(0, 100)}...</p>
            <small class="text-muted">Por ${post.autor} em ${post.data}</small>
          `;

            // Copia o usuarioId do localStorage para o sessionStorage, se ainda n√£o estiver l√°
            const usuarioId = localStorage.getItem("usuarioId");
            if (usuarioId && !sessionStorage.getItem("usuarioId")) {
              sessionStorage.setItem("usuarioId", usuarioId);
            }


            card.addEventListener("click", () => {
              localStorage.setItem("postSelecionado", JSON.stringify(post));
              window.location.href = "post.html";
            });

            lista.appendChild(card);
          });
        }
      } else {
        titulo.textContent = "G√™nero n√£o especificado.";
        lista.innerHTML = `<p class="text-muted">Selecione um g√™nero no menu lateral.</p>`;
      }
    });
  </script>
</body>

</html>